---
title: "Same Innovator's Proportion Research"
author: "Zehao Qian"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# --------------------------------------------------------
gc()
rm(list = ls())
graphics.off()
cat("\014")
# --------------------------------------------------------
folder_name <- "./pic_same_inno_prop_research"
if (dir.exists(folder_name)) {
  unlink(folder_name, recursive = TRUE)
}
dir.create(folder_name)
```

Data Set: Simulation 3

-   N = 1000

-   p = 0.01

-   q = 0.3

-   Iteration = 25

-   Innovator Prop = 0.01

-   Influential Innovator Prop = [0, 0.003, 0.005, 0.007, 0.01]

```{r}
library(data.table)
simulation3_results = fread("./simulation3.csv")
```

```{r}
library(tidyr)
library(dplyr)

data.box = simulation3_results %>%
  filter(AgentID == 0, Step == 100)
```

```{r}
library(jsonlite)
data.box$agent_proportion_list = lapply(data.box$agent_proportion, fromJSON)
data.box$prop_inf_inno = sapply(data.box$agent_proportion_list, function(x) x[1])
```

```{r}
data.box.long = data.box %>%
  pivot_longer(cols = starts_with("Steps_to"), 
               names_to = "Step_Percent", 
               values_to = "Steps_Count") %>%
  mutate(prop_inf_inno_number = case_when(
    prop_inf_inno == 0 ~ "Inf Inno = 0",
    prop_inf_inno == 0.003 ~ "Inf Inno = 0.003",
    prop_inf_inno == 0.005 ~ "Inf Inno = 0.005",
    prop_inf_inno == 0.007 ~ "Inf Inno = 0.007",
    prop_inf_inno == 0.01 ~ "Inf Inno = 0.01",
    TRUE ~ NA_character_
  ))
```

```{r}
box = ggplot(data.p.change.long) +
  aes(x = p_number, y = Steps_Count, fill = p) +
  geom_boxplot() +
  scale_fill_gradient() +
  labs(
    x = "Different P Number",
    y = "Steps Count",
    title = "Boxplot for Potential User Acceptance Ratio",
    subtitle = "When the acceptance probability of innovator changes (p)"
  ) +
  theme_light() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5)
  ) +
  facet_wrap(vars(Step_Percent))


```

```{r fig.height=9, fig.width=16}
library(ggplot2)

box = ggplot(data.box.long) +
  aes(
    x = prop_inf_inno_number,
    y = Steps_Count,
    fill = prop_inf_inno
  ) +
  geom_boxplot() +
  scale_fill_viridis_c(option = "plasma", direction = 1) +
  labs(
    x = "Change the Proportion of Influencial Innovator",
    y = "Steps Count",
    title = "Boxplot for Potential User Acceptance ",
    subtitle = "Proportion of Innovator = 0.01"
  ) +
  theme_light() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5)
  ) +
  facet_wrap(vars(Step_Percent))

ggsave("./pic_same_inno_prop_research/box.png",
       plot = box,
       device = "png",
       height = 9,
       width = 16)

box
```
